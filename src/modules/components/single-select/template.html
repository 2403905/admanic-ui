<!-- search input -->
<div class="adm-select__input" [formGroup]="form">
    <textarea
            spellcheck="false"
            rows="1"
            [placeholder]="placeholder"
            (click)="inputClick($event)"
            (keyup.enter)="onEnterClick($event)"
            (keydown.enter)="onEnterKeydown($event)"
            (focus)="startSearch($event)"
            formControlName="queryStr"></textarea>

    <!-- toggle button -->
    <button class="adm-select__caret" type="button" (click)="toggleOpen($event)">
        toggle
    </button>
    <!-- / toggle button -->

    <!-- view link -->
    <template [ngIf]="_viewPath && value">
        <div class="adm-select__view-item">
            <a class="adm-select__view-item__btn" target="_blank" href="{{_viewPath}}/{{value}}">
                View <i class="material-icons">launch</i>
            </a>
        </div>
    </template>
    <!-- /view link -->
</div>
<!-- / search input -->

<!-- options list wrapper -->
<div class="adm-select__options">
    <!-- lists results -->
    <ul class="adm-select__options__list">
        <!-- template for list without groups -->
        <template [ngIf]="!hasGroups">
            <li *ngFor="let item of options; trackBy: trackListByFn;"
                [ngClass]="{'hidden':item.hidden, 'is-selected':item.selected}"
                (click)="onSelect(item.value)">{{item.label}}
            </li>
        </template>
        <!-- / template for list without groups -->


        <!-- template for list with groups -->
        <template [ngIf]="hasGroups">
            <template ngFor let-group [ngForOf]="options" let-i="index">
                <p [ngClass]="{'hidden':group.hidden}">{{group.name}}</p>
                <li *ngFor="let item of group?.values; trackBy: trackListByFn;"
                    [ngClass]="{'hidden':item.hidden, 'is-selected':item.selected}"
                    (click)="onSelect(item.value)">{{item.label}}
                </li>
            </template>
        </template>
        <!-- / template for list with groups -->

        <!-- results el -->
        <li *ngIf="!allowCreateEntity && nothingNotFound && (options?.length || (!options?.length && queryStr?.value))">
            {{pendingRequest ? 'Searching...' : 'No results found'}}
        </li>

        <li *ngIf="!options?.length && queryStr?.value?.length==0">
            {{pendingRequest ? 'Searching...' : 'No results found'}}
        </li>
        <!-- / results el -->

        <!-- add new entity btn -->
        <li *ngIf="allowCreateEntity && nothingNotFound && queryStr?.value.length>0" (click)="addNewOption($event);">
            {{queryStr.value}} <b>{{newItemPostfix}}</b>
        </li>
        <!-- / add new entity btn -->

    </ul>
    <!-- / lists results -->

    <!-- clear selection btn -->
    <ul *ngIf="allowClear && options.length && !nothingNotFound && value"
        class="adm-select__options__list clear-selection">
        <li (click)="clearSelection($event)">None</li>
    </ul>
    <!-- / clear selection btn -->

    <!-- add new btn -->
    <button *ngIf="showAddNewBtn" class="adm-select__add-new-btn" type="button" (click)="onAddNewBtnClick($event)">
        <i class="material-icons">add</i> Add new
    </button>
    <!-- / add new btn -->
</div>
<!-- / options list wrapper -->

<!-- validators -->
<adm-validator-messages *ngIf="allowCreateEntity" [field]="form.get('queryStr')"></adm-validator-messages>
<!-- / validators -->

